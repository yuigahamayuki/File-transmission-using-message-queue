# File-transmission-using-message-queue
这是一个在同一机器上的不同进程间传输文件的客户端/服务器端程序，文件请求和文件响应都通过POSIX消息队列
## 整体工作流程
(a)启动服务器，创建、并打开一个消息队列用于文件请求，服务器对此消息队列只读，循环等待请求；\
(b)启动客户端，启动参数加上要请求的文件名；\
(c)客户端创建、并打开一个消息队列用于接收文件，该消息队列的名字后接此客户端的进程ID；\
(d)客户端使用管道和mq_notify()函数以及epoll来知道何时上一步创建的消息队列有消息到来，即要接收的文件到来；\
(e)客户端打开步骤(a)服务器创建的文件请求消息队列，客户端对它只写，客户端调用mq_send()把自己的进程ID和请求的文件名发送给消息队列，之后调用epoll_wait
等待通知；\
(f)服务器收到上一步步骤(e)客户端发来的消息后，fork出一个子进程，检查要传输的文件名，打开此文件，并用客户端发来的进程ID打开步骤(c)客户端创建的消息队列，
把文件内容发送到该消息队列，然后退出子进程；\
(g)客户端epoll_wait返回1，客户端调用mq_receive()把文件内容从消息队列放到buffer中，再新建一个文件，把buffer的内容写到文件里；\
(h)客户端完成文件传输，调用mq_close()和mq_unlink()来删除消息队列文件。
